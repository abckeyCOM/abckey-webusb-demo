(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57954163"],{"09f2":function(e,t,r){"use strict";const n=r("09f3").Reporter,o=r("bab3").EncoderBuffer,i=r("bab3").DecoderBuffer,s=r("da3e"),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],a=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c),u=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function l(e,t,r){const n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n["default"]=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}e.exports=l;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];l.prototype.clone=function(){const e=this._baseState,t={};f.forEach((function(r){t[r]=e[r]}));const r=new this.constructor(t.parent);return r._baseState=t,r},l.prototype._wrap=function(){const e=this._baseState;a.forEach((function(t){this[t]=function(){const r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}}),this)},l.prototype._init=function(e){const t=this._baseState;s(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),s.equal(t.children.length,1,"Root node can have only one child")},l.prototype._useArgs=function(e){const t=this._baseState,r=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==r.length&&(s(null===t.children),t.children=r,r.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(s(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!==typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(r){r==(0|r)&&(r|=0);const n=e[r];t[n]=r})),t})))},u.forEach((function(e){l.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),c.forEach((function(e){l.prototype[e]=function(){const t=this._baseState,r=Array.prototype.slice.call(arguments);return s(null===t.tag),t.tag=e,this._useArgs(r),this}})),l.prototype.use=function(e){s(e);const t=this._baseState;return s(null===t.use),t.use=e,this},l.prototype.optional=function(){const e=this._baseState;return e.optional=!0,this},l.prototype.def=function(e){const t=this._baseState;return s(null===t["default"]),t["default"]=e,t.optional=!0,this},l.prototype.explicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.explicit=e,this},l.prototype.implicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.implicit=e,this},l.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},l.prototype.key=function(e){const t=this._baseState;return s(null===t.key),t.key=e,this},l.prototype.any=function(){const e=this._baseState;return e.any=!0,this},l.prototype.choice=function(e){const t=this._baseState;return s(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},l.prototype.contains=function(e){const t=this._baseState;return s(null===t.use),t.contains=e,this},l.prototype._decode=function(e,t){const r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));let n,o=r["default"],s=!0,c=null;if(null!==r.key&&(c=e.enterKey(r.key)),r.optional){let n=null;if(null!==r.explicit?n=r.explicit:null!==r.implicit?n=r.implicit:null!==r.tag&&(n=r.tag),null!==n||r.any){if(s=this._peekTag(e,n,r.any),e.isError(s))return s}else{const n=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),s=!0}catch(a){s=!1}e.restore(n)}}if(r.obj&&s&&(n=e.enterObject()),s){if(null!==r.explicit){const t=this._decodeTag(e,r.explicit);if(e.isError(t))return t;e=t}const n=e.offset;if(null===r.use&&null===r.choice){let t;r.any&&(t=e.save());const n=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(n))return n;r.any?o=e.raw(t):e=n}if(t&&t.track&&null!==r.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),r.any||(o=null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t)),e.isError(o))return o;if(r.any||null!==r.choice||null===r.children||r.children.forEach((function(r){r._decode(e,t)})),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){const n=new i(o);o=this._getUse(r.contains,e._reporterState.obj)._decode(n,t)}}return r.obj&&s&&(o=e.leaveObject(n)),null===r.key||null===o&&!0!==s?null!==c&&e.exitKey(c):e.leaveKey(c,r.key,o),o},l.prototype._decodeGeneric=function(e,t,r){const n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],r):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},l.prototype._getUse=function(e,t){const r=this._baseState;return r.useDecoder=this._use(e,t),s(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},l.prototype._decodeChoice=function(e,t){const r=this._baseState;let n=null,o=!1;return Object.keys(r.choice).some((function(i){const s=e.save(),c=r.choice[i];try{const r=c._decode(e,t);if(e.isError(r))return!1;n={type:i,value:r},o=!0}catch(a){return e.restore(s),!1}return!0}),this),o?n:e.error("Choice not matched")},l.prototype._createEncoderBuffer=function(e){return new o(e,this.reporter)},l.prototype._encode=function(e,t,r){const n=this._baseState;if(null!==n["default"]&&n["default"]===e)return;const o=this._encodeValue(e,t,r);return void 0===o||this._skipDefault(o,t,r)?void 0:o},l.prototype._encodeValue=function(e,t,r){const o=this._baseState;if(null===o.parent)return o.children[0]._encode(e,t||new n);let i=null;if(this.reporter=t,o.optional&&void 0===e){if(null===o["default"])return;e=o["default"]}let s=null,c=!1;if(o.any)i=this._createEncoderBuffer(e);else if(o.choice)i=this._encodeChoice(e,t);else if(o.contains)s=this._getUse(o.contains,r)._encode(e,t),c=!0;else if(o.children)s=o.children.map((function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");const n=t.enterKey(r._baseState.key);if("object"!==typeof e)return t.error("Child expected, but input is not object");const o=r._encode(e[r._baseState.key],t,e);return t.leaveKey(n),o}),this).filter((function(e){return e})),s=this._createEncoderBuffer(s);else if("seqof"===o.tag||"setof"===o.tag){if(!o.args||1!==o.args.length)return t.error("Too many args for : "+o.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const r=this.clone();r._baseState.implicit=null,s=this._createEncoderBuffer(e.map((function(r){const n=this._baseState;return this._getUse(n.args[0],e)._encode(r,t)}),r))}else null!==o.use?i=this._getUse(o.use,r)._encode(e,t):(s=this._encodePrimitive(o.tag,e),c=!0);if(!o.any&&null===o.choice){const e=null!==o.implicit?o.implicit:o.tag,r=null===o.implicit?"universal":"context";null===e?null===o.use&&t.error("Tag could be omitted only for .use()"):null===o.use&&(i=this._encodeComposite(e,c,r,s))}return null!==o.explicit&&(i=this._encodeComposite(o.explicit,!1,"context",i)),i},l.prototype._encodeChoice=function(e,t){const r=this._baseState,n=r.choice[e.type];return n||s(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),n._encode(e.value,t)},l.prototype._encodePrimitive=function(e,t){const r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},l.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},l.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},"09f3":function(e,t,r){"use strict";const n=r("3fb5");function o(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function i(e,t){this.path=e,this.rethrow(t)}t.Reporter=o,o.prototype.isError=function(e){return e instanceof i},o.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},o.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},o.prototype.enterKey=function(e){return this._reporterState.path.push(e)},o.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},o.prototype.leaveKey=function(e,t,r){const n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=r)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},o.prototype.leaveObject=function(e){const t=this._reporterState,r=t.obj;return t.obj=e,r},o.prototype.error=function(e){let t;const r=this._reporterState,n=e instanceof i;if(t=n?e:new i(r.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!r.options.partial)throw t;return n||r.errors.push(t),t},o.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},n(i,Error),i.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,i),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},"0c5d":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("v-row",[r("v-col",{attrs:{cols:"2"}},[r("v-btn",{attrs:{color:"primary",large:"",block:""},on:{click:function(t){return e.userSetPublicKey()}}},[e._v(e._s(e.$t("User Set Public Key")))]),r("br"),r("v-textarea",{attrs:{label:e.$t("RSA Public Key (PEM)")},model:{value:e.d_rsaPEM,callback:function(t){e.d_rsaPEM=t},expression:"d_rsaPEM"}}),r("v-textarea",{attrs:{label:e.$t("ECDSA Private Key (PEM)")},model:{value:e.d_ecPEM,callback:function(t){e.d_ecPEM=t},expression:"d_ecPEM"}})],1),r("v-col",{attrs:{cols:"5"}},[r("v-textarea",{attrs:{label:e.$t("Request"),value:e.d_request,filled:"",readonly:"","auto-grow":""}})],1),r("v-col",{attrs:{cols:"5"}},[r("v-textarea",{attrs:{label:e.$t("Response"),value:e.d_response,filled:"",readonly:"","auto-grow":""}})],1)],1)],1)},o=[],i=r("637a"),s=i["a"],c=r("2877"),a=Object(c["a"])(s,n,o,!1,null,"fc2381ce",null);t["default"]=a.exports},1057:function(e,t,r){"use strict";const n=r("9ecd"),o=new n;o.define("Version",r("9785")),o.define("OtherPrimeInfos",r("83ab9")),o.define("AlgorithmIdentifier",r("8651")),o.define("PrivateKeyInfo",r("e396")),o.define("PublicKeyInfo",r("f5f9")),o.define("RSAPrivateKey",r("52b4")),o.define("RSAPublicKey",r("837c")),o.define("ECPrivateKey",r("3a90")),e.exports=o},"11d6":function(e,t,r){"use strict";const n=r("3fb5"),o=r("891d");function i(e){o.call(this,e),this.enc="pem"}n(i,o),e.exports=i,i.prototype.encode=function(e,t){const r=o.prototype.encode.call(this,e),n=r.toString("base64"),i=["-----BEGIN "+t.label+"-----"];for(let o=0;o<n.length;o+=64)i.push(n.slice(o,o+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}},"2add":function(e,t,r){"use strict";const n=r("3fb5"),o=r("399f"),i=r("bab3").DecoderBuffer,s=r("09f2"),c=r("788d");function a(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new u,this.tree._init(e.body)}function u(e){s.call(this,"der",e)}function l(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;const n=c.tagClass[r>>6],o=0===(32&r);if(31===(31&r)){let n=r;r=0;while(128===(128&n)){if(n=e.readUInt8(t),e.isError(n))return n;r<<=7,r|=127&n}}else r&=31;const i=c.tag[r];return{cls:n,primitive:o,tag:r,tagStr:i}}function f(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&128===n)return null;if(0===(128&n))return n;const o=127&n;if(o>4)return e.error("length octect is too long");n=0;for(let i=0;i<o;i++){n<<=8;const t=e.readUInt8(r);if(e.isError(t))return t;n|=t}return n}e.exports=a,a.prototype.decode=function(e,t){return i.isDecoderBuffer(e)||(e=new i(e,t)),this.tree._decode(e,t)},n(u,s),u.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;const n=e.save(),o=l(e,'Failed to peek tag: "'+t+'"');return e.isError(o)?o:(e.restore(n),o.tag===t||o.tagStr===t||o.tagStr+"of"===t||r)},u.prototype._decodeTag=function(e,t,r){const n=l(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;let o=f(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(o))return o;if(!r&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==o)return e.skip(o,'Failed to match body of: "'+t+'"');const i=e.save(),s=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(s)?s:(o=e.offset-i.offset,e.restore(i),e.skip(o,'Failed to match body of: "'+t+'"'))},u.prototype._skipUntilEnd=function(e,t){for(;;){const r=l(e,t);if(e.isError(r))return r;const n=f(e,r.primitive,t);if(e.isError(n))return n;let o;if(o=r.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(o))return o;if("end"===r.tagStr)break}},u.prototype._decodeList=function(e,t,r,n){const o=[];while(!e.isEmpty()){const t=this._peekTag(e,"end");if(e.isError(t))return t;const i=r.decode(e,"der",n);if(e.isError(i)&&t)break;o.push(i)}return o},u.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");let r="";for(let e=0;e<t.length/2;e++)r+=String.fromCharCode(t.readUInt16BE(2*e));return r}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},u.prototype._decodeObjid=function(e,t,r){let n;const o=[];let i=0,s=0;while(!e.isEmpty())s=e.readUInt8(),i<<=7,i|=127&s,0===(128&s)&&(o.push(i),i=0);128&s&&o.push(i);const c=o[0]/40|0,a=o[0]%40;if(n=r?o:[c,a].concat(o.slice(1)),t){let e=t[n.join(" ")];void 0===e&&(e=t[n.join(".")]),void 0!==e&&(n=e)}return n},u.prototype._decodeTime=function(e,t){const r=e.raw().toString();let n,o,i,s,c,a;if("gentime"===t)n=0|r.slice(0,4),o=0|r.slice(4,6),i=0|r.slice(6,8),s=0|r.slice(8,10),c=0|r.slice(10,12),a=0|r.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|r.slice(0,2),o=0|r.slice(2,4),i=0|r.slice(4,6),s=0|r.slice(6,8),c=0|r.slice(8,10),a=0|r.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,o-1,i,s,c,a,0)},u.prototype._decodeNull=function(){return null},u.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},u.prototype._decodeInt=function(e,t){const r=e.raw();let n=new o(r);return t&&(n=t[n.toString(10)]||n),n},u.prototype._use=function(e,t){return"function"===typeof e&&(e=e(t)),e._getDecoder("der").tree}},"2e74":function(e,t,r){"use strict";const n=r("396d");class o{constructor(e){this.params=e}fromPrivatePKCS1(e){throw new n}fromPrivatePKCS8(e){throw new n}fromPublicPKCS1(e){throw new n}fromPublicPKCS8(e){throw new n}fromPrivateBlk(e){throw new n}fromPublicBlk(e){throw new n}fromJwk(e){throw new n}toPrivatePKCS1(e){throw new n}toPrivatePKCS8(e){throw new n}toPublicPKCS1(e){throw new n}toPublicPKCS8(e){throw new n}toPrivateBlk(e){throw new n}toPublicBlk(e){throw new n}toPrivateJwk(e){throw new n}toPublicJwk(e){throw new n}static formatPem(e,t){return`-----BEGIN ${t} KEY-----\n`+e.match(/.{1,64}/g).join("\n")+`\n-----END ${t} KEY-----`}}e.exports=o},"2ed3":function(e,t,r){"use strict";const n=t;n.der=r("891d"),n.pem=r("11d6")},"396d":function(e,t,r){"use strict";class n extends Error{constructor(){super("This has not been implemented yet")}}e.exports=n},"3a90":function(e,t,r){"use strict";e.exports=e=>function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().choice({namedCurve:this.objid()}),this.key("publicKey").explicit(1).optional().bitstr())}},"445d":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r("bd4b");function o(t,r){return void 0===r&&(r="utf8"),e.isBuffer(t)?c(t.toString("base64")):c(e.from(t,r).toString("base64"))}function i(t,r){return void 0===r&&(r="utf8"),e.from(s(t),"base64").toString(r)}function s(e){return e=e.toString(),n.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function c(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(t){return e.from(s(t),"base64")}var u=o;u.encode=o,u.decode=i,u.toBase64=s,u.fromBase64=c,u.toBuffer=a,t.default=u}).call(this,r("b639").Buffer)},"52b4":function(e,t,r){"use strict";e.exports=e=>{let t=e.normalize("Version"),r=e.normalize("OtherPrimeInfos");return function(){this.seq().obj(this.key("version").use(t),this.key("n").int(),this.key("e").int(),this.key("d").int(),this.key("p").int(),this.key("q").int(),this.key("dp").int(),this.key("dq").int(),this.key("qi").int(),this.key("other").optional().use(r))}}},5405:function(e,t,r){"use strict";const n=r("3fb5"),o=r("c591").Buffer,i=r("2add");function s(e){i.call(this,e),this.enc="pem"}n(s,i),e.exports=s,s.prototype.decode=function(e,t){const r=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/;let c=-1,a=-1;for(let o=0;o<r.length;o++){const e=r[o].match(s);if(null!==e&&e[2]===n){if(-1!==c){if("END"!==e[1])break;a=o;break}if("BEGIN"!==e[1])break;c=o}}if(-1===c||-1===a)throw new Error("PEM section not found for: "+n);const u=r.slice(c+1,a).join("");u.replace(/[^a-z0-9+/=]+/gi,"");const l=o.from(u,"base64");return i.prototype.decode.call(this,l,t)}},"5b5d":function(e,t,r){"use strict";const n=t;n.der=r("2add"),n.pem=r("5405")},"637a":function(e,t,r){"use strict";(function(e){r("d3b7"),r("25f0"),r("96cf");var n=r("1da1"),o=r("c104"),i=r.n(o),s=r("7d92"),c=r.n(s),a=r("3337"),u=new a["ec"]("secp256k1");t["a"]={name:"ChangePin",data:function(){return{d_rsaPEM:"",d_ecPEM:"",d_response:"",d_request:""}},mounted:function(){this.d_rsaPEM="-----BEGIN PUBLIC KEY-----\nMIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQBatZZ+iuWgttWENbHZMfHF\ngvD8uzuhQ9bVQ4vwnDa+YdRuSP1ay1oXdG0tO0cEQh3lnhaezrQOnc/27gp3vlKw\nj7L0/68lWqXlKtZ128iIItZBYAbcWQGu7oi9zvbrBNXX+L/Lq4A2dS8fhurF82kn\nNFruoyttMSH8pGb8wQLrGHk9mLLA/HEJoD2gg6EzC92Bbw+WoCvy3mQjpkeo1QqO\n1egC+evR/8Is/qtGGTf2YqjEvl4iN4yD8Dv0rOVQMbBB76z7Re4KGe6lVBM1tTmh\n4xFIUfpmrtzHtXicxbMJ1gLqXLqcvRQQLFsU75gZWMvEV+TO/7C0qkfvvIrelbjV\nAgMBAAE=\n-----END PUBLIC KEY-----",this.d_ecPEM="-----BEGIN EC PRIVATE KEY-----\nMHQCAQEEILrLJDUVtiut0FHwKs3LGig3LgeOW/mkNrpkLO5PGIB5oAcGBSuBBAAK\noUQDQgAEvsPs11I7wcaCN4BuDB0Tv5QCOSY0xscagJFKNrWrbSII87XCflJs1xYi\nthsrjXg4wP/lojqdkWBhSmQAzc4Vjw==\n-----END EC PRIVATE KEY-----"},methods:{userSetPublicKey:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var n,o,s,a,l,f,d,p,h,y,b,m;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=i.a.from(t.d_rsaPEM,"pem").toJwk("public"),o=i.a.from(t.d_ecPEM,"pem").toString("blk","private"),n){r.next=4;break}return r.abrupt("return");case 4:if(o){r.next=6;break}return r.abrupt("return");case 6:return s=e.from(n.n,"base64").toString("hex").toUpperCase(),a=e.from(n.e,"base64").toString("hex").toUpperCase(),l=a+s,f=c.a.sha256().update(l).digest("hex").toUpperCase(),d=u.keyFromPrivate(o),p=u.sign(f,d),h=p.r.toString("hex"),y=p.s.toString("hex"),b={rsa_e:a,rsa_n:s,sig_r:h,sig_s:y},r.next=17,t.$usb.cmd("UserSetPublicKey",b);case 17:m=r.sent,t.d_request='abckey.cmd("UserSetPublicKey", '+JSON.stringify(b,null,4)+")",t.d_response=JSON.stringify(m,null,4);case 20:case"end":return r.stop()}}),r)})))()}},i18n:{messages:{zhCN:{"User Set Public Key":"导入公钥","RSA Public Key (PEM)":"RSA 公钥(PEM)","ECDSA Private Key (PEM)":"ECDSA 私钥(PEM)"}}}}}).call(this,r("b639").Buffer)},"6c35":function(e,t,r){"use strict";(function(t){const n=r("2e74"),o=r("a93e"),i=r("1057");class s extends n{fromPrivatePKCS8(e){const t=i.normalize("PrivateKeyInfo"),r=t.decode(e,"der"),n=r.privateKey.slice(2),o=this.publicKeyFromPrivate(n);return{d:n,x:o}}fromPublicPKCS8(e){const t=i.normalize("PublicKeyInfo"),r=t.decode(e,"der");return{x:o.convert(r.publicKey.data,"hex","raw")}}fromJwk(e){let{d:t,x:r}=e;return{d:o.convert(t,"base64url","raw"),x:o.convert(r,"base64url","raw")}}toPrivatePKCS8(e){let{oid:t,infoVersion:r}=this.params,{d:n}=e;const o=i.normalize("PrivateKeyInfo"),c=this.privateKeyPadding(n);let a=o.encode({version:r,algorithm:{algorithm:t.split(".")},privateKey:c},"der").toString("base64");return s.formatPem(a,"PRIVATE")}toPublicPKCS8(e){let{oid:t}=this.params,{x:r}=e,n=i.normalize("PublicKeyInfo"),c=n.encode({algorithm:{algorithm:t.split(".")},publicKey:{unused:0,data:o.convert(r,"hex","raw")}},"der").toString("base64");return s.formatPem(c,"PUBLIC")}toPrivateJwk(e){let{crv:t,kty:r}=this.params,{d:n,x:i}=e;return{kty:r,crv:t,d:o.convert(n,"raw","base64url"),x:o.convert(i,"raw","base64url")}}toPublicJwk(e){let{crv:t,kty:r}=this.params,{x:n}=e;return{kty:r,crv:t,x:o.convert(n,"raw","base64url")}}privateKeyPadding(e){let r;switch(this.params.crv){case"Ed25519":r=t.from("0420","hex");break;default:throw new Error(`${this.params.crv} is an invalid curve for EdDSA`)}return t.concat([r,e],r.length+e.length)}publicKeyFromPrivate(e){switch(this.params.crv){case"Ed25519":const n=r("3337").eddsa,o=new n("ed25519");return t.from(o.keyFromSecret(e).getPublic());default:throw new Error(`${this.params.crv} is an invalid curve for EdDSA`)}}}e.exports=s}).call(this,r("b639").Buffer)},7525:function(e,t,r){"use strict";const n=t;n.Reporter=r("09f3").Reporter,n.DecoderBuffer=r("bab3").DecoderBuffer,n.EncoderBuffer=r("bab3").EncoderBuffer,n.Node=r("09f2")},7813:function(e,t,r){"use strict";class n{constructor(){this.registry=[],this.classes={}}find(e){return this.registry.find(e)}define(e,t){e.forEach(e=>{let{kty:r}=e;if(!r)throw new Error("Invalid type definition");this.classes[r]||(this.classes[r]=t),this.registry.push(e)})}normalize(e,t,r){let n=this.classes[e],o=this.find(e=>e[t]===r);if(!n||!o)throw new Error("Invalid type");return new n(o)}}e.exports=n},"788d":function(e,t,r){"use strict";function n(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t}t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=n(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=n(t.tag)},"837c":function(e,t,r){"use strict";e.exports=e=>function(){this.seq().obj(this.key("n").int(),this.key("e").int())}},"83ab9":function(e,t,r){"use strict";e.exports=e=>function(){this.seq().obj(this.key("ri").int(),this.key("di").int(),this.key("ti").int())}},8651:function(e,t,r){"use strict";e.exports=e=>function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}},"891d":function(e,t,r){"use strict";const n=r("3fb5"),o=r("c591").Buffer,i=r("09f2"),s=r("788d");function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new a,this.tree._init(e.body)}function a(e){i.call(this,"der",e)}function u(e){return e<10?"0"+e:e}function l(e,t,r,n){let o;if("seqof"===e?e="seq":"setof"===e&&(e="set"),s.tagByName.hasOwnProperty(e))o=s.tagByName[e];else{if("number"!==typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);o=e}return o>=31?n.error("Multi-octet tag encoding unsupported"):(t||(o|=32),o|=s.tagClassByName[r||"universal"]<<6,o)}e.exports=c,c.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(a,i),a.prototype._encodeComposite=function(e,t,r,n){const i=l(e,t,r,this.reporter);if(n.length<128){const e=o.alloc(2);return e[0]=i,e[1]=n.length,this._createEncoderBuffer([e,n])}let s=1;for(let o=n.length;o>=256;o>>=8)s++;const c=o.alloc(2+s);c[0]=i,c[1]=128|s;for(let o=1+s,a=n.length;a>0;o--,a>>=8)c[o]=255&a;return this._createEncoderBuffer([c,n])},a.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=o.alloc(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},a.prototype._encodeObjid=function(e,t,r){if("string"===typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let o=0;o<e.length;o++){let t=e[o];for(n++;t>=128;t>>=7)n++}const i=o.alloc(n);let s=i.length-1;for(let o=e.length-1;o>=0;o--){let t=e[o];i[s--]=127&t;while((t>>=7)>0)i[s--]=128|127&t}return this._createEncoderBuffer(i)},a.prototype._encodeTime=function(e,t){let r;const n=new Date(e);return"gentime"===t?r=[u(n.getUTCFullYear()),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[u(n.getUTCFullYear()%100),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},a.prototype._encodeNull=function(){return this._createEncoderBuffer("")},a.prototype._encodeInt=function(e,t){if("string"===typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!==typeof e&&!o.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=o.from(t)}if(o.isBuffer(e)){let t=e.length;0===e.length&&t++;const r=o.alloc(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let o=e;o>=256;o>>=8)r++;const n=new Array(r);for(let o=n.length-1;o>=0;o--)n[o]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(o.from(n))},a.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},a.prototype._use=function(e,t){return"function"===typeof e&&(e=e(t)),e._getEncoder("der").tree},a.prototype._skipDefault=function(e,t,r){const n=this._baseState;let o;if(null===n["default"])return!1;const i=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n["default"],t,r).join()),i.length!==n.defaultBuffer.length)return!1;for(o=0;o<i.length;o++)if(i[o]!==n.defaultBuffer[o])return!1;return!0}},"8e97":function(e,t,r){"use strict";(function(t){const n=r("2e74"),o=(r("9330"),r("a93e")),i=r("1057");class s extends n{fromPrivatePKCS1(e){let t=i.normalize("RSAPrivateKey"),{n:r,e:n,d:s,p:c,q:a,dp:u,dq:l,qi:f}=t.decode(e,"der");return{n:o.convert(r,"bn","raw"),e:o.convert(n,"bn","raw"),d:o.convert(s,"bn","raw"),p:o.convert(c,"bn","raw"),q:o.convert(a,"bn","raw"),dp:o.convert(u,"bn","raw"),dq:o.convert(l,"bn","raw"),qi:o.convert(f,"bn","raw")}}fromPrivatePKCS8(e){let t=i.normalize("PrivateKeyInfo"),r=i.normalize("RSAPrivateKey"),n=t.decode(e,"der"),{n:s,e:c,d:a,p:u,q:l,dp:f,dq:d,qi:p}=r.decode(n.privateKey,"der");return{n:o.convert(s,"bn","raw"),e:o.convert(c,"bn","raw"),d:o.convert(a,"bn","raw"),p:o.convert(u,"bn","raw"),q:o.convert(l,"bn","raw"),dp:o.convert(f,"bn","raw"),dq:o.convert(d,"bn","raw"),qi:o.convert(p,"bn","raw")}}fromPublicPKCS1(e){let t=i.normalize("RSAPublicKey"),{n:r,e:n}=t.decode(e,"der");return{n:o.convert(r,"bn","raw"),e:o.convert(n,"bn","raw")}}fromPublicPKCS8(e){let t=i.normalize("PublicKeyInfo"),r=i.normalize("RSAPublicKey"),n=t.decode(e,"der"),{n:s,e:c}=r.decode(n.publicKey.data,"der");return{n:o.convert(s,"bn","raw"),e:o.convert(c,"bn","raw")}}fromJwk(e){let{n:t,e:r,d:n,p:i,q:s,dp:c,dq:a,qi:u,alg:l}=e;return{n:o.convert(t,"base64url","raw"),e:o.convert(r,"base64url","raw"),d:o.convert(n,"base64url","raw"),p:o.convert(i,"base64url","raw"),q:o.convert(s,"base64url","raw"),dp:o.convert(c,"base64url","raw"),dq:o.convert(a,"base64url","raw"),qi:o.convert(u,"base64url","raw")}}toPrivatePKCS1(e){let{n:t,e:r,d:n,p:c,q:a,dp:u,dq:l,qi:f}=e,{version:d}=this.params,p=i.normalize("RSAPrivateKey"),h=p.encode({version:d,n:o.convert(t,"raw","bn"),e:o.convert(r,"raw","bn"),d:o.convert(n,"raw","bn"),p:o.convert(c,"raw","bn"),q:o.convert(a,"raw","bn"),dp:o.convert(u,"raw","bn"),dq:o.convert(l,"raw","bn"),qi:o.convert(f,"raw","bn")},"der").toString("base64");return s.formatPem(h,"RSA PRIVATE")}toPrivatePKCS8(e){let{n:r,e:n,d:c,p:a,q:u,dp:l,dq:f,qi:d}=e,{oid:p,algParameters:h,version:y}=this.params,b=i.normalize("PrivateKeyInfo"),m=i.normalize("RSAPrivateKey"),g=m.encode({version:y,n:o.convert(r,"raw","bn"),e:o.convert(n,"raw","bn"),d:o.convert(c,"raw","bn"),p:o.convert(a,"raw","bn"),q:o.convert(u,"raw","bn"),dp:o.convert(l,"raw","bn"),dq:o.convert(f,"raw","bn"),qi:o.convert(d,"raw","bn")},"der"),v=b.encode({version:y,algorithm:{algorithm:p.split("."),parameters:t.from(h,"hex")},privateKey:g},"der").toString("base64");return s.formatPem(v,"PRIVATE")}toPublicPKCS1(e){let{n:t,e:r}=e,{version:n}=this.params,c=i.normalize("RSAPublicKey"),a=c.encode({version:n,n:o.convert(t,"raw","bn"),e:o.convert(r,"raw","bn")},"der").toString("base64");return s.formatPem(a,"RSA PUBLIC")}toPublicPKCS8(e){let{n:r,e:n}=e,{oid:c,algParameters:a}=this.params,u=i.normalize("PublicKeyInfo"),l=i.normalize("RSAPublicKey"),f=l.encode({n:o.convert(r,"raw","bn"),e:o.convert(n,"raw","bn")},"der"),d=u.encode({algorithm:{algorithm:c.split("."),parameters:t.from(a,"hex")},publicKey:{unused:0,data:f}},"der").toString("base64");return s.formatPem(d,"PUBLIC")}toPrivateJwk(e){let{n:t,e:r,d:n,p:i,q:s,dp:c,dq:a,qi:u}=e,{kty:l}=this.params;return{kty:l,n:o.convert(t,"raw","base64url"),e:o.convert(r,"raw","base64url"),d:o.convert(n,"raw","base64url"),p:o.convert(i,"raw","base64url"),q:o.convert(s,"raw","base64url"),dp:o.convert(c,"raw","base64url"),dq:o.convert(a,"raw","base64url"),qi:o.convert(u,"raw","base64url")}}toPublicJwk(e){let{n:t,e:r}=e,{kty:n}=this.params;return{kty:n,n:o.convert(t,"raw","base64url"),e:o.convert(r,"raw","base64url")}}}e.exports=s}).call(this,r("b639").Buffer)},9330:function(e,t,r){"use strict";class n extends Error{constructor(e){super(e||"This operation is not supported for this key type")}}e.exports=n},9785:function(e,t,r){"use strict";e.exports=e=>function(){this.int({0:"two-prime",1:"multi"})}},"9def":function(e,t,r){"use strict";const n=t;n.bignum=r("399f"),n.define=r("c083").define,n.base=r("7525"),n.constants=r("f89a"),n.decoders=r("5b5d"),n.encoders=r("2ed3")},"9ecd":function(e,t,r){"use strict";const n=r("9def");class o{constructor(){Object.defineProperty(this,"_registry",{value:{}})}get registry(){return this._registry}define(e,t){this._registry[e]=n.define(e,t(this))}normalize(e){return this.registry[e]}}e.exports=o},a93e:function(e,t,r){"use strict";(function(t){const n=r("9def"),o=r("fb4d");class i{static convert(e,r,i){if(!e)return;if(r===i)return e;let s;if("raw"===r||e instanceof t)s=e;else if("uint8_array"===r||Array.isArray(e))s=t.from(e);else if("hex"===r)s=t.from(e,"hex");else if("base64"===r)s=t.from(e,"base64");else if("base64url"===r)s=o.toBuffer(e);else{if("bn"!==r&&"bignum"!==r)throw new Error("Invalid fromType");s=t.from(this.pad(e.toString(16)),"hex")}if("raw"===i)return s;if("uint8_array"===i)return Array.from(s);if("hex"===i)return s.toString("hex");if("base64"===i)return s.toString("base64");if("base64url"===i)return o.fromBase64(s.toString("base64"));if("bn"===i||"bignum"===i)return new n.bignum(s);throw new Error("Invalid toType")}static pad(e){return e.length%2===1?`0${e}`:e}}e.exports=i}).call(this,r("b639").Buffer)},af14:function(e,t,r){"use strict";const n=r("7813"),o=r("8e97"),i=r("d284"),s=r("6c35"),c=new n;c.define([{kty:"RSA",oid:"1.2.840.113549.1.1.1",algParameters:"0500",version:"two-prime"}],o),c.define([{kty:"EC",crv:"K-256",oid:"1.2.840.10045.2.1",namedCurve:"1.3.132.0.10",algParameters:"06052b8104000a",keyVersion:1,infoVersion:"two-prime"},{kty:"EC",crv:"P-256",oid:"1.2.840.10045.2.1",namedCurve:"1.2.840.10045.3.1.7",algParameters:"06082a8648ce3d030107",keyVersion:1,infoVersion:"two-prime"},{kty:"EC",crv:"P-384",oid:"1.2.840.10045.2.1",namedCurve:"1.3.132.0.34",algParameters:"06052b81040022",keyVersion:1,infoVersion:"two-prime"},{kty:"EC",crv:"P-521",oid:"1.2.840.10045.2.1",namedCurve:"1.3.132.0.35",algParameters:"06052b81040023",keyVersion:1,infoVersion:"two-prime"}],i),c.define([{kty:"OKP",crv:"Ed25519",oid:"1.3.101.112",infoVersion:"two-prime"}],s),e.exports=c},bab3:function(e,t,r){"use strict";const n=r("3fb5"),o=r("09f3").Reporter,i=r("c591").Buffer;function s(e,t){o.call(this,t),i.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function c(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return c.isEncoderBuffer(e)||(e=new c(e,t)),this.length+=e.length,e}),this);else if("number"===typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"===typeof e)this.value=e,this.length=i.byteLength(e);else{if(!i.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}n(s,o),t.DecoderBuffer=s,s.isDecoderBuffer=function(e){if(e instanceof s)return!0;const t="object"===typeof e&&i.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"===typeof e.offset&&"number"===typeof e.length&&"function"===typeof e.save&&"function"===typeof e.restore&&"function"===typeof e.isEmpty&&"function"===typeof e.readUInt8&&"function"===typeof e.skip&&"function"===typeof e.raw;return t},s.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},s.prototype.restore=function(e){const t=new s(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,o.prototype.restore.call(this,e.reporter),t},s.prototype.isEmpty=function(){return this.offset===this.length},s.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},s.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const r=new s(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},s.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.EncoderBuffer=c,c.isEncoderBuffer=function(e){if(e instanceof c)return!0;const t="object"===typeof e&&"EncoderBuffer"===e.constructor.name&&"number"===typeof e.length&&"function"===typeof e.join;return t},c.prototype.join=function(e,t){return e||(e=i.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(r){r.join(e,t),t+=r.length})):("number"===typeof this.value?e[t]=this.value:"string"===typeof this.value?e.write(this.value,t):i.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},bd4b:function(e,t,r){"use strict";(function(e){function r(t){var r=4,n=t.length,o=n%r;if(!o)return t;var i=n,s=r-o,c=n+s,a=e.alloc(c);a.write(t);while(s--)a.write("=",i++);return a.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}).call(this,r("b639").Buffer)},c083:function(e,t,r){"use strict";const n=r("2ed3"),o=r("5b5d"),i=r("3fb5"),s=t;function c(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}s.define=function(e,t){return new c(e,t)},c.prototype._createNamed=function(e){const t=this.name;function r(e){this._initNamed(e,t)}return i(r,e),r.prototype._initNamed=function(t,r){e.call(this,t,r)},new r(this)},c.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(o[e])),this.decoders[e]},c.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},c.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},c.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)}},c104:function(e,t,r){"use strict";(function(t){const n=r("9330"),o=r("396d"),i=r("af14"),s=r("1057"),c=RegExp("\r?\n","g");class a{constructor(e,t){if(!e)throw new n("key is required");if(!t)throw new n("options are required");let{kty:r,format:o,selector:i,crv:s,oid:c}=t;if(!t.kty)throw new n("options.kty is required");if(!t.format)throw new n("options.format is required");if(!t.selector)throw new n("options.selector is required");if(!t.crv&&!t.oid)throw new n("options.crv or options.oid is required");this.kty=r,this.format=o,this.selector=i,this.crv=s,this.oid=c,this.key=this.parseKey(e)}static from(e,r){if(!e)throw new n("key is required");if(!r)throw new n("format is required");if("jwk"===r){let t;if("string"===typeof e)try{t=JSON.parse(e)}catch(o){throw new n("key is not a valid JWK")}else"object"===typeof e&&(t=e);let s,{kty:c,crv:u}=t;if(!c)throw new n("kty is required for JWK");if("EC"===c&&!u)throw new n("crv is required for EC JWK");"RSA"===c&&(s=i.find(e=>e.kty===c).oid);let l=t.d?"private":"public";return new a(t,{kty:c,crv:u,oid:s,format:r,selector:l})}if("pem"===r){if("string"!==typeof e)throw new n("key is not a valid PEM string");let o=e.split(c),u=o.splice(0,1);o.splice(o.length-1,1);let l,f,d=o.join(""),p=/^-----BEGIN ((RSA|EC) )?(PUBLIC|PRIVATE) KEY-----$/.exec(u),h=p?p[2]:void 0,y=p?p[3]:void 0,b=t.from(d,"base64");if(!y)throw new n("key is not a valid PEM string");if(h){if("RSA"===h)y="PRIVATE"===y?"private_pkcs1":"public_pkcs1",l=i.find(e=>e.kty===h).oid;else if("EC"===h){let e;if("PRIVATE"===y){let t=s.normalize(`${h}PrivateKey`);y="private_pkcs1",e=t.decode(b,"der")}else if("PUBLIC"===y){let t=s.normalize(`${h}PrivateKey`);y="public_pkcs1",e=t.decode(b,"der")}let{parameters:{value:t}}=e;f=i.find(e=>e.namedCurve===t.join(".")).crv}}else{let e,t=s.normalize("PrivateKeyInfo"),r=s.normalize("PublicKeyInfo");"PRIVATE"===y?(y="private_pkcs8",e=t.decode(b,"der")):"PUBLIC"===y&&(y="public_pkcs8",e=r.decode(b,"der"));let{algorithm:{algorithm:o,parameters:c}}=e;o=o.join("."),c=c?c.toString("hex"):void 0;const a=i.find(e=>e.oid===o);if(h=a?a.kty:void 0,!h)throw new n(`${o} is not supported`);"RSA"===h||"OKP"===h?l=o:"EC"===h&&(f=i.find(e=>e.algParameters===c).crv)}return new a(b,{kty:h,oid:l,crv:f,format:r,selector:y})}if("blk"===r)return new a(e,{kty:"EC",crv:"K-256",format:r,selector:e.length>64?"public":"private"});throw new n(`Invalid format ${r}`)}get alg(){let{kty:e,crv:t,oid:r}=this;if(!this.algorithm){if(t)Object.defineProperty(this,"algorithm",{value:i.normalize(e,"crv",t)});else{if(!r)throw new Error("Both crv and oid are undefined");Object.defineProperty(this,"algorithm",{value:i.normalize(e,"oid",r)})}if(!this.algorithm)throw new Error(`${this.crv||this.oid} is not implemented yet`)}return this.algorithm}parseKey(e){let{alg:t,format:r,selector:n}=this;if("pem"===r)switch(n){case"public_pkcs1":return t.fromPublicPKCS1(e);case"public_pkcs8":return t.fromPublicPKCS8(e);case"private_pkcs1":return t.fromPrivatePKCS1(e);case"private_pkcs8":return t.fromPrivatePKCS8(e);default:throw new Error("Invalid selector value")}if("jwk"===r)return t.fromJwk(e,n);if("blk"===r)switch(n){case"public":return t.fromPublicBlk(e);case"private":return t.fromPrivateBlk(e)}}toJwk(e){let{key:t,alg:r,selector:i}=this;switch(e){case"public":return r.toPublicJwk(t);case"private":if(i.includes("public"))throw new n("Cannot export a private key from a public key");return r.toPrivateJwk(t);default:throw new Error("Invalid key selector")}throw new o}toString(e="pem",t="public_pkcs8"){let{key:r,alg:i,selector:s}=this;if("pem"===e)switch(t){case"public_pkcs1":return i.toPublicPKCS1(r);case"public_pkcs8":return i.toPublicPKCS8(r);case"private_pkcs1":if(s.includes("public"))throw new n("Cannot export a private key from a public key");return i.toPrivatePKCS1(r);case"private_pkcs8":if(s.includes("public"))throw new n("Cannot export a private key from a public key");return i.toPrivatePKCS8(r);default:throw new Error("Invalid key selector")}else if("jwk"===e)switch(t){case"public":return JSON.stringify(i.toPublicJwk(r));case"private":if(s.includes("public"))throw new n("Cannot export a private key from a public key");return JSON.stringify(i.toPrivateJwk(r));default:throw new Error("Invalid key selector")}else if("blk"===e)switch(t){case"private":if(s.includes("public"))throw new n("Cannot export a private key from a public key");return i.toPrivateBlk(r);case"public":return i.toPublicBlk(r);default:throw new Error("Invalid key selector")}throw new o}}e.exports=a}).call(this,r("b639").Buffer)},c591:function(e,t,r){"use strict";(function(t){var n,o=r("b639"),i=o.Buffer,s={};for(n in o)o.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(s[n]=o[n]);var c=s.Buffer={};for(n in i)i.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(c[n]=i[n]);if(s.Buffer.prototype=i.prototype,c.from&&c.from!==Uint8Array.from||(c.from=function(e,t,r){if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&"undefined"===typeof e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return i(e,t,r)}),c.alloc||(c.alloc=function(e,t,r){if("number"!==typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=i(e);return t&&0!==t.length?"string"===typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!s.kStringMaxLength)try{s.kStringMaxLength=t.binding("buffer").kStringMaxLength}catch(a){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s}).call(this,r("4362"))},d284:function(e,t,r){"use strict";(function(t){r("9def").bignum;const n=r("3337").ec,o=new n("secp256k1"),i=r("2e74"),s=(r("9330"),r("a93e")),c=r("1057");class a extends i{fromPrivatePKCS1(e){let t=c.normalize("ECPrivateKey"),r=t.decode(e,"der"),{privateKey:n,publicKey:{data:o}}=r,i=s.convert(o,"raw","hex"),{x:u,y:l}=a.getPoint(i);return{d:n,x:u,y:l}}fromPrivatePKCS8(e){let t=c.normalize("PrivateKeyInfo"),r=c.normalize("ECPrivateKey"),n=t.decode(e,"der"),o=r.decode(n.privateKey,"der"),{privateKey:i,publicKey:{data:u}}=o,l=s.convert(u,"raw","hex"),{x:f,y:d}=a.getPoint(l);return{d:i,x:f,y:d}}fromPublicPKCS8(e){let t=c.normalize("PublicKeyInfo"),r=t.decode(e,"der"),n=s.convert(r.publicKey.data,"raw","hex");return a.getPoint(n)}fromPrivateBlk(e){let t=o.keyFromPrivate(e,"hex"),r=t.getPublic();return{d:s.convert(t.priv,"bn","raw"),x:s.convert(r.getX(),"bn","raw"),y:s.convert(r.getY(),"bn","raw")}}fromPublicBlk(e){return a.getPoint(e)}fromJwk(e){let{d:t,x:r,y:n}=e;return{d:s.convert(t,"base64url","raw"),x:s.convert(r,"base64url","raw"),y:s.convert(n,"base64url","raw")}}toPrivatePKCS1(e){let{namedCurve:t,keyVersion:r}=this.params,{d:n,x:o,y:i}=e,s=c.normalize("ECPrivateKey"),u=a.makePoint(o,i),l=s.encode({version:r,privateKey:n,parameters:{type:"namedCurve",value:t.split(".")},publicKey:{unused:0,data:u}},"der").toString("base64");return a.formatPem(l,"EC PRIVATE")}toPrivatePKCS8(e){let{oid:r,algParameters:n,keyVersion:o,infoVersion:i}=this.params,{d:s,x:u,y:l}=e,f=c.normalize("PrivateKeyInfo"),d=c.normalize("ECPrivateKey"),p=a.makePoint(u,l),h=d.encode({version:o,privateKey:s,publicKey:{unused:0,data:p}},"der"),y=f.encode({version:i,algorithm:{algorithm:r.split("."),parameters:t.from(n,"hex")},privateKey:h},"der").toString("base64");return a.formatPem(y,"PRIVATE")}toPublicPKCS8(e){let{oid:r,algParameters:n}=this.params,{x:o,y:i}=e,s=c.normalize("PublicKeyInfo"),u=a.makePoint(o,i),l=s.encode({algorithm:{algorithm:r.split("."),parameters:t.from(n,"hex")},publicKey:{unused:0,data:u}},"der").toString("base64");return a.formatPem(l,"PUBLIC")}toPrivateBlk(e){return e.d.toString("hex")}toPublicBlk(e){return s.convert(a.makePoint(e.x,e.y),"raw","hex")}toPrivateJwk(e){let{crv:t,kty:r}=this.params,{d:n,x:o,y:i}=e;return{kty:r,crv:t,d:s.convert(n,"raw","base64url"),x:s.convert(o,"raw","base64url"),y:s.convert(i,"raw","base64url")}}toPublicJwk(e){let{crv:t,kty:r}=this.params,{x:n,y:o}=e;return{kty:r,crv:t,x:s.convert(n,"raw","base64url"),y:s.convert(o,"raw","base64url")}}static getPoint(e){let t=e.slice(2,(e.length-2)/2+2),r=e.slice((e.length-2)/2+2);return{x:s.convert(t,"hex","raw"),y:s.convert(r,"hex","raw")}}static makePoint(e,r){let n=t.from("04","hex");return t.concat([n,e,r],n.length+e.length+r.length)}}e.exports=a}).call(this,r("b639").Buffer)},e396:function(e,t,r){"use strict";e.exports=e=>{let t=e.normalize("Version"),r=e.normalize("AlgorithmIdentifier");return function(){this.seq().obj(this.key("version").use(t),this.key("algorithm").use(r),this.key("privateKey").octstr())}}},f5f9:function(e,t,r){"use strict";e.exports=e=>{let t=e.normalize("AlgorithmIdentifier");return function(){this.seq().obj(this.key("algorithm").use(t),this.key("publicKey").bitstr())}}},f89a:function(e,t,r){"use strict";const n=t;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t},n.der=r("788d")},fb4d:function(e,t,r){e.exports=r("445d").default,e.exports.default=e.exports}}]);